<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.6 at 2018-01-24 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Dev Center: API Docs &#x2013; Query Justification</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <style type="text/css" media="all">
      @import url("../../../../css/maven-base.css");
      @import url("../../../../css/maven-theme.css");
      @import url("../../../../css/site.css");
    </style>
    <link rel="stylesheet" href="../../../../css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20180124" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                        <a href="http://www.cyc.com/" id="bannerLeft">
                                                <img src="../../../../../images/cyclogo.png" alt="Dev Center (dev.cyc.com)" />
                </a>
                          <div id="bannerRight">
                Cyc Developer Center
                </div>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2018-01-24</span>
                  &nbsp;| <span id="projectVersion">Version: 1.1.1</span>
                          |                           <a href="../../../../../" title="Cyc Dev Center">Cyc Dev Center</a>
        &gt;
                          <a href="../../../../index.html" title="APIs">APIs</a>
        &gt;
    Query Justification
              </div>
            <div class="xright">                    <a href="http://www.cyc.com/" class="externalLink" title="Cycorp">Cycorp</a>
            |
                        <a href="../../../../../" title="Developer Center">Developer Center</a>
            |
                        <a href="../../../../../api/" title="Java APIs">Java APIs</a>
            |
                        <a href="../../../../../ontology-development/" title="Ontologies">Ontologies</a>
            |
                        <a href="../../../../../admin/" title="Cyc Administration">Cyc Administration</a>
            |
                        <a href="../../../../../downloads/" title="Downloads">Downloads</a>
            |
                        <a href="../../../../../issues/" title="Issues">Issues</a>
            |
                        <a href="https://github.com/cycorp" class="externalLink" title="GitHub">GitHub</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Cyc Developer Center</h5>
                  <ul>
                  <li class="none">
                          <a href="../../../../../index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="../../../../../issues/index.html" title="Issues">Issues</a>
            </li>
                  <li class="none">
                          <a href="../../../../../downloads/index.html" title="Downloads">Downloads</a>
            </li>
                  <li class="none">
                          <a href="../../../../../xsd/index.html" title="Cyc XSDs">Cyc XSDs</a>
            </li>
                  <li class="none">
                          <a href="../../../../../xsl/index.html" title="Cyc XSL">Cyc XSL</a>
            </li>
          </ul>
                       <h5>Java APIs</h5>
                  <ul>
                  <li class="none">
                          <a href="../../../../index.html" title="Overview">Overview</a>
            </li>
                                                                                                                                                        <li class="expanded">
                          <a href="../../../../core/index.html" title="Core API Suite">Core API Suite</a>
                    <ul>
                      <li class="none">
                          <a href="../../../../core/kb/index.html" title="KB API">KB API</a>
            </li>
                      <li class="none">
                          <a href="../../../../core/query/index.html" title="Query API">Query API</a>
            </li>
                      <li class="none">
                          <a href="../../../../core/session/index.html" title="Session API">Session API</a>
            </li>
                      <li class="none">
                          <a href="../../../../core/readme.html" title="README">README</a>
            </li>
                      <li class="none">
                          <a href="../../../../core/changelog.html" title="CHANGELOG">CHANGELOG</a>
            </li>
                      <li class="none">
                          <a href="../../../../core/download/index.html" title="Download">Download</a>
            </li>
              </ul>
        </li>
                  <li class="none">
                          <a href="../../../../faq/index.html" title="FAQs & HOWTOs">FAQs & HOWTOs</a>
            </li>
                  <li class="none">
                          <a href="../../../../license/index.html" title="License">License</a>
            </li>
          </ul>
                       <h5>Javadocs</h5>
                  <ul>
                  <li class="none">
                          <a href="../../../../core/apidocs/" title="Core API Spec">Core API Spec</a>
            </li>
                  <li class="none">
                          <a href="../../../../core/client/apidocs/" title="Core Client Impl">Core Client Impl</a>
            </li>
          </ul>
                       <h5>Examples</h5>
                  <ul>
                                                                                                                                    <li class="expanded">
                          <a href="../../../../samples/index.html" title="API Usage">API Usage</a>
                    <ul>
                      <li class="none">
                          <a href="../../../../samples/core/index.html" title="Basic Core API Usage">Basic Core API Usage</a>
            </li>
                      <li class="none">
                          <a href="../../../../samples/core/query/advanced/index.html" title="Advanced Querying">Advanced Querying</a>
            </li>
                                                                      <li class="expanded">
            <strong>Query Justification</strong>
                  <ul>
                      <li class="none">
                          <a href="../../../../samples/core/query/justification/marshalling/index.html" title="XML Marshalling">XML Marshalling</a>
            </li>
              </ul>
        </li>
              </ul>
        </li>
          </ul>
                       <h5>Ontology Development</h5>
                  <ul>
                  <li class="none">
                          <a href="../../../../../ontology-development/index.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="../../../../../ontology-development/tutorials/index.html" title="Tutorials">Tutorials</a>
            </li>
                                                                                                                    <li class="expanded">
                          <a href="http://www.cyc.com/documentation/ontologists-handbook/" class="externalLink" title="Ontologist's Handbook">Ontologist's Handbook</a>
                    <ul>
                      <li class="none">
                          <a href="http://www.cyc.com/documentation/ontologists-handbook/cyc-basics/" class="externalLink" title="Cyc Basics">Cyc Basics</a>
            </li>
                      <li class="none">
                          <a href="http://www.cyc.com/documentation/ontologists-handbook/writing-efficient-cycl/" class="externalLink" title="Efficient CycL">Efficient CycL</a>
            </li>
                      <li class="none">
                          <a href="http://www.cyc.com/documentation/ontologists-handbook/tools-knowledge-editing-and-ontology-development/" class="externalLink" title="Tools">Tools</a>
            </li>
                      <li class="none">
                          <a href="http://www.cyc.com/documentation/ontologists-handbook/cycl-queries/" class="externalLink" title="CycL Queries">CycL Queries</a>
            </li>
              </ul>
        </li>
                                                                                                                    <li class="expanded">
                          <a href="../../../../../ontology-development/references/index.html" title="References">References</a>
                    <ul>
                      <li class="none">
                          <a href="http://www.cyc.com/resource/cyc-vocabulary/" class="externalLink" title="Cyc Vocabulary">Cyc Vocabulary</a>
            </li>
                      <li class="none">
                          <a href="http://www.cyc.com/documentation/glossary" class="externalLink" title="Glossary">Glossary</a>
            </li>
                      <li class="none">
                          <a href="http://www.cyc.com/documentation/abbreviations/" class="externalLink" title="Common Cyc Abbreviations">Common Cyc Abbreviations</a>
            </li>
                      <li class="none">
                          <a href="http://www.cyc.com/thing/" class="externalLink" title="KB Hierarchy diagram">KB Hierarchy diagram</a>
            </li>
              </ul>
        </li>
          </ul>
                       <h5>Cyc Administration</h5>
                  <ul>
                  <li class="none">
                          <a href="http://www.cyc.com/documentation/enterprise-cyc-administrator-handbook/" class="externalLink" title="Cyc Admin Handbook">Cyc Admin Handbook</a>
            </li>
                  <li class="none">
                          <a href="../../../../../admin/faq/index.html" title="Cyc Admin FAQ">Cyc Admin FAQ</a>
            </li>
          </ul>
                                          
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h2><a name="Query_Justification"></a>Query Justification</h2>
<p>Below is a complete file providing a sample implementation for viewing query-answer justifications. This code is not meant to be copied and pasted verbatim (though it does work), but rather is intended to illustrate how to create and navigate a ProofViewJustification object. NOTE: Query justification is not supported in OpenCyc.</p>
<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/default.min.css">
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>
$(document).ready(function() {
  $('div.source pre').each(function(i, e) {hljs.highlightBlock(e)});
});
</script>

<div class="source">
<pre>package com.cyc.core.examples.advanced;

/*
 * #%L
 * File: QueryAnswerJustifying.java
 * Project: Cyc Core API Use Cases
 * %%
 * Copyright (C) 1995 - 2014 Cycorp, Inc
 * %%
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * #L%
 */

import com.cyc.query.ProofView;
import com.cyc.query.ProofViewNode;
import com.cyc.query.ProofViewSpecification;
import com.cyc.query.Query;
import com.cyc.session.SessionManager;
import com.cyc.session.exception.SessionCommunicationException;
import java.io.IOException;
import java.util.Iterator;
import net.htmlparser.jericho.Source;
import net.htmlparser.jericho.TextExtractor;

/**
 * This example runs a simple query, and then computes and displays the justification for the first
 * answer that comes back from Cyc.
 */
public class QueryAnswerJustifying {

  public static void main(String[] args) {
    final String exampleName = QueryAnswerJustifying.class.getSimpleName();
    try (SessionManager sessionMgr = SessionManager.getInstance()) {
      System.out.println(&quot;Running &quot; +  exampleName + &quot;...&quot;);
      Query combinedQuery = Query.get(&quot;(and (isa ?X PubliclyHeldCorporation) (stockTickerSymbol ?X ?Y))&quot;, &quot;InferencePSC&quot;);
      //In order to justify an answer, the inference itself needs to still be present on the Cyc server.&quot;
      combinedQuery.retainInference();

      displayAnswerJustification(combinedQuery);

      /* Closing isn't strictly necessary in this case, since we're about to exit the program,
       but it's still good form to clean up inferences as soon as you can.
       */
      combinedQuery.close();
    } catch (Exception ex) {
      ex.printStackTrace(System.err);
      System.exit(1);
    } finally {
      System.out.println(&quot;... &quot; +  exampleName + &quot; concluded.&quot;);
      System.exit(0);
    }
  }

  public static void displayAnswerJustification(final Query query)
          throws IOException, SessionCommunicationException {
    /* This is the place to set other parameters on the justification that would then be obeyed when 
    it is populated.  Populating the justification fills in all the structures, and makes sure they
    have both the detailed structure, and also the relevant natural language strings.
    */
    ProofViewSpecification proofViewSpec = ProofViewSpecification.get();
    /* Get the justification for a particular answer.  In this case, we get the very first answer
    that came back. */
    ProofView proofView = ProofView.getProofView(query.getAnswer(0), proofViewSpec);
    displayJustification(proofView);
  }

  /* The next two methods show how to traverse a justification.  In a real application, you'd probably
  want to do something more complicated than this with each of the nodes.  */
  public static void displayJustification(final ProofView proofView) 
          throws IOException {
    System.out.println(&quot;\n============= Justification ================&quot;);
    final Iterator&lt;ProofViewNode&gt; iter = proofView.toDepthFirstIterator();
    while (iter.hasNext()) {
      displayJustificationNode(iter.next());
    }
  }
  
  public static void displayJustificationNode(final ProofViewNode node) throws IOException {
    final StringBuilder renderer = new StringBuilder();
    // Indent according to node's depth:
    for (int i = 0; i &lt; node.getDepth(); i++) {
      renderer.append(' ');
    }
    // Render initially hidden nodes with parens:
    final boolean expandInitially = node.isExpandInitially();
    if (!expandInitially) {
      renderer.append('(');
    }
    // Render the node's HTML, or the label:
    final String html = node.getHTML();
    if (html == null || html.isEmpty()) {
      final String label = node.getLabel();
      if (label != null) {
        renderer.append(label);
      }
    } else {
      // Render HTML as text:
      new TextExtractor(new Source(html)).appendTo(renderer);
    }
    if (!expandInitially) {
      renderer.append(')');
    }
    System.out.println(renderer);
  }


}
</pre></div></div>
      </div>

<!--
      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'cycdev'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </div>
-->

    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2015&#x2013;2018
                        <a href="http://www.cyc.com">Cycorp, Inc</a>.
            All rights reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
