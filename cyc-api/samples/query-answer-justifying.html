<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.6 at 2015-03-14 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Cyc Java API &#x2013; Query Justification</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20150314" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                        <a href="http://www.cyc.com/" id="bannerLeft">
                                                <img src="../images/cyclogo.png" alt="Cyc Java API" />
                </a>
                          <div id="bannerRight">
                Cyc Java API
                </div>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2015-03-14</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0.0-rc1</span>
                      </div>
            <div class="xright">                    <a href="http://www.cyc.com/" class="externalLink" title="Cycorp">Cycorp</a>
            |
                        <a href="../../index.html" title="Developer Center">Developer Center</a>
            |
                        <a href="../index.html" title="Java API Resources">Java API Resources</a>
            |
                        <a href="../issues.html" title="Issues">Issues</a>
            |
                        <a href="../apidocs/index.html" title="Javadocs">Javadocs</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Cyc Developer Center</h5>
                  <ul>
                  <li class="none">
                          <a href="../../index.html" title="Introduction">Introduction</a>
            </li>
          </ul>
                       <h5>Cyc Java API</h5>
                  <ul>
                                                                                                        <li class="collapsed">
                          <a href="../index.html" title="Overview">Overview</a>
                  </li>
                  <li class="none">
                          <a href="../apidocs/" title="Javadocs">Javadocs</a>
            </li>
                                                                                                                                                      <li class="expanded">
                          <a href="../samples/index.html" title="Sample Code">Sample Code</a>
                    <ul>
                      <li class="none">
                          <a href="../samples/combined.html" title="Core API Usages">Core API Usages</a>
            </li>
                      <li class="none">
                          <a href="../samples/advanced-querying.html" title="Advanced Querying">Advanced Querying</a>
            </li>
                      <li class="none">
                          <a href="../samples/query-construction.html" title="Query Construction">Query Construction</a>
            </li>
                      <li class="none">
                          <a href="../samples/query-search.html" title="Query Search">Query Search</a>
            </li>
                      <li class="none">
            <strong>Query Justification</strong>
          </li>
              </ul>
        </li>
                  <li class="none">
                          <a href="../faq.html" title="FAQ">FAQ</a>
            </li>
                  <li class="none">
                          <a href="../download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="../issues.html" title="Issues">Issues</a>
            </li>
                  <li class="none">
                          <a href="../license.html" title="License">License</a>
            </li>
                  <li class="none">
                          <a href="../migration.html" title="Migration Guide">Migration Guide</a>
            </li>
          </ul>
                                          
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h2><a name="Query_Justification"></a>Query Justification</h2>
<p>Below is a complete file providing a sample implementation for viewing query-answer justifications. This code is not meant to be copied and pasted verbatim (though it does work), but rather is intended to illustrate how to create and navigate a ProofViewJustification object. NOTE: Query justification is not supported in OpenCyc.</p>
<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/default.min.css">
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>
$(document).ready(function() {
  $('div.source pre').each(function(i, e) {hljs.highlightBlock(e)});
});
</script>

<div class="source">
<pre>package com.cyc.km.query.construction;

/*
 * #%L
 * File: QueryAnswerJustifying.java
 * Project: Cyc API Use Cases
 * %%
 * Copyright (C) 1995 - 2014 Cycorp, Inc
 * %%
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * #L%
 */

import com.cyc.base.CycApiException;
import com.cyc.base.CycConnectionException;
import com.cyc.base.CycTimeOutException;
import com.cyc.base.justification.Justification;
import com.cyc.baseclient.justification.JustificationWalker;
import com.cyc.km.query.answer.justification.ProofViewJustification;
import com.cyc.query.Query;
import com.cyc.session.CycSessionManager;
import java.io.IOException;
import net.htmlparser.jericho.Source;
import net.htmlparser.jericho.TextExtractor;

public class QueryAnswerJustifying {

  /* This example runs a simple query, and then computes and displays the justification for the 
  first answer that comes back from Cyc. */
  public static void main(String[] args) {
    final String exampleName = QueryAnswerJustifying.class.getSimpleName();
    try {
      System.out.println(&quot;Running &quot; +  exampleName + &quot;...&quot;);
      
      if (CycSessionManager.getCurrentSession().getServerInfo().isOpenCyc()) {
        System.out.println(&quot;The \&quot;Query Justification\&quot; feature is not available in OpenCyc.&quot;);
        System.out.println(&quot;... &quot; +  exampleName + &quot; concluded.&quot;);
        System.exit(0);
      }
      Query combinedQuery = new Query(&quot;(and (isa ?X PubliclyHeldCorporation) (stockTickerSymbol ?X ?Y))&quot;, &quot;InferencePSC&quot;);
      //In order to justify an answer, the inference itself needs to still be present on the Cyc server.&quot;
      combinedQuery.retainInference();

      displayAnswerJustification(combinedQuery);

      /* Closing isn't strictly necessary in this case, since we're about to exit the program,
       but it's still good form to clean up inferences as soon as you can.
       */
      combinedQuery.close();
    } catch (Exception ex) {
      ex.printStackTrace(System.err);
      System.exit(1);
    } finally {
      System.out.println(&quot;... &quot; +  exampleName + &quot; concluded.&quot;);
      System.exit(0);
    }
  }

  public static void displayAnswerJustification(final Query query)
          throws CycApiException, CycTimeOutException, CycConnectionException, IOException {
    /* Get the justification for a particular answer.  In this case, we get the very first answer
    that came back. */
    final Justification justification = new ProofViewJustification(query.getAnswer(0));
    /* Immediately after creation, the justification is little more than a promisory note.  This 
    would be the place to set other parameters on the justification that would then be obeyed when 
    it is populated.  Populating the justification fills in all the structures, and makes sure they
    have both the detailed structure, and also the relevant natural language strings.
    */
    justification.populate();
    displayJustification(justification);
  }


  /* The next two methods show how to traverse a justification.  In a real application, you'd probably
  want to do something more complicated than this with each of the nodes.  */
  public static void displayJustification(final Justification justification) throws IOException {
    System.out.println(&quot;\n============= Justification ================&quot;);
    for (final JustificationWalker walker = new JustificationWalker(
            justification); walker.hasNext();) {
      displayJustificationNode(walker.next());
    }
  }
  public static void displayJustificationNode(final Justification.Node node) throws IOException {
    final StringBuilder renderer = new StringBuilder();
    // Indent according to node's depth:
    for (int i = 0; i &lt; node.getDepth(); i++) {
      renderer.append(' ');
    }
    // Render initially hidden nodes with parens:
    final boolean expandInitially = node.isExpandInitially();
    if (!expandInitially) {
      renderer.append('(');
    }
    // Render the node's HTML, or the label:
    final String html = node.getHTML();
    if (html == null || html.isEmpty()) {
      final String label = node.getLabel();
      if (label != null) {
        renderer.append(label);
      }
    } else {
      // Render HTML as text:
      new TextExtractor(new Source(html)).appendTo(renderer);
    }
    if (!expandInitially) {
      renderer.append(')');
    }
    System.out.println(renderer);
  }


}
</pre></div></div>
      </div>


      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'cycdev'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </div>



    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2013&#x2013;2015
                        <a href="http://www.cyc.com">Cycorp, Inc</a>.
            All rights reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
